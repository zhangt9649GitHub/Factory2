<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mingyuansoftware.aifactory.mapper.StorageGoodsMapper" >
  <resultMap id="BaseResultMap" type="com.mingyuansoftware.aifactory.model.StorageGoods" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="storage_goods_id" property="storageGoodsId" jdbcType="INTEGER" />
    <result column="storage_access_id" property="storageAccessId" jdbcType="INTEGER" />
    <result column="goods_id" property="goodsId" jdbcType="INTEGER" />
    <result column="quantity" property="quantity" jdbcType="DECIMAL" />
    <result column="amount" property="amount" jdbcType="DECIMAL" />
    <result column="comment" property="comment" jdbcType="VARCHAR" />
      <association column="goods_id" property="goods"
                   select="com.mingyuansoftware.aifactory.mapper.GoodsMapper.selectByPrimaryKey"></association>
  </resultMap>

  <resultMap id="StorageDetailResultMap" type="com.mingyuansoftware.aifactory.model.StorageGoodsDetail" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="storage_goods_id" property="storageGoodsId" jdbcType="INTEGER" />
    <result column="storage_access_id" property="storageAccessId" jdbcType="INTEGER" />
    <result column="goods_id" property="goodsId" jdbcType="INTEGER" />
    <result column="quantity" property="quantity" jdbcType="DECIMAL" />
    <result column="amount" property="amount" jdbcType="DECIMAL" />
    <result column="parts_cd" property="partsCd" jdbcType="VARCHAR" />
    <result column="goods_name" property="goodsName" jdbcType="VARCHAR" />
    <result column="specification" property="specification" jdbcType="VARCHAR" />
    <result column="storage_number" property="storageNumber" jdbcType="VARCHAR" />
    <result column="lot_number" property="lotNumber" jdbcType="VARCHAR" />
    <result column="type" property="type" jdbcType="VARCHAR" />
    <result column="a_price" property="aPrice" jdbcType="DECIMAL" />
    <result column="b_price" property="bPrice" jdbcType="DECIMAL" />
    <result column="ruku_time" property="rukuTime" jdbcType="VARCHAR" />
    <result column="warehouse_name" property="warehouseName" jdbcType="VARCHAR" />


  </resultMap>



  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from storage_goods
    where storage_access_id = #{storageAccessId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.mingyuansoftware.aifactory.model.StorageGoods" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey resultType="java.lang.Integer" keyProperty="storageGoodsId" order="AFTER" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into storage_goods (storage_access_id, goods_id, quantity, 
      amount, `comment`)
    values (#{storageAccessId,jdbcType=INTEGER}, #{goodsId,jdbcType=INTEGER}, #{quantity,jdbcType=DECIMAL}, 
      #{amount,jdbcType=DECIMAL}, #{comment,jdbcType=VARCHAR})
  </insert>
  <update id="updateByPrimaryKey" parameterType="com.mingyuansoftware.aifactory.model.StorageGoods" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update storage_goods
    set storage_access_id = #{storageAccessId,jdbcType=INTEGER},
      goods_id = #{goodsId,jdbcType=INTEGER},
      quantity = #{quantity,jdbcType=DECIMAL},
      amount = #{amount,jdbcType=DECIMAL},
      `comment` = #{comment,jdbcType=VARCHAR}
    where storage_goods_id = #{storageGoodsId,jdbcType=INTEGER}
  </update>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select sg.storage_goods_id, sg.storage_access_id, sg.goods_id, sg.quantity, sg.amount, sg.`comment`
    from storage_goods sg
    where sg.storage_access_id = #{storageAccessId,jdbcType=INTEGER}
  </select>
  <select id="selectAll" resultType="com.mingyuansoftware.aifactory.model.StorageGoodsDetail" parameterType="com.mingyuansoftware.aifactory.model.StorageGoodsDetail">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select g.parts_cd, g.goods_name, g.specification, sg.storage_goods_id, sg.storage_access_id, sg.goods_id, sg.quantity, sg.amount,
    sa.storage_number,sa.ruku_time,sa.type,wh.warehouse_name,sa.lot_number,g.a_price,g.b_price
    from storage_goods sg
    LEFT JOIN goods g on (g.goods_id =sg.goods_id)
    LEFT JOIN storage_access sa on (sa.storage_access_id =sg.storage_access_id)
    LEFT JOIN warehouse wh on (sa.warehouse_id =wh.warehouse_id)
    <where>
      <if test="partsCd!= null and partsCd != ''">
        AND g.parts_cd like "%"#{partsCd}"%"
      </if>
      <if test="rukuTime != null and rukuTime!= ''">
        AND sa.ruku_time like "%"#{rukuTime}"%"
      </if>
      <if test="goodsName != null and goodsName != ''">
        AND g.goods_name like "%"#{goodsName}"%"
      </if>
      <if test="warehouseName != null and warehouseName != ''">
        AND  wh.warehouse_name like "%"#{warehouseName}"%"
      </if>
      <if test="type != null and type != ''">
        AND  sa.`type` like "%"#{type}"%"
      </if>
      <if test="specification != null and specification != ''">
        AND g.specification = #{specification}
      </if>

      <if test="quantity != null and quantity != ''">
        AND sg.quantity like "%"#{quantity}"%"
      </if>
      <if test="amount != null and amount != ''">
        AND  sg.amount like "%"#{amount}"%"
      </if>
      <if test="storageNumber != null and storageNumber != ''">
        AND  sa.storage_number like "%"#{storageNumber}"%"
      </if>
      <if test="lotNumber != null and lotNumber != ''">
        AND sa.lot_number = #{lotNumber}
      </if>

      <if test="aPrice != null and aPrice != ''">
        AND  g.a_price like "%"#{aPrice}"%"
      </if>
      <if test="bPrice != null and bPrice != ''">
        AND  g.b_price like "%"#{bPrice}"%"
      </if>
      <if test="beginDate != null and beginDate != ''">
        AND sa.ruku_time <![CDATA[>=]]> #{beginDate}
      </if>
      <if test="endDate != null and endDate != ''">
        AND sa.ruku_time <![CDATA[<=]]>#{endDate}
      </if>

      AND sa.is_delete = 0 AND wh.is_delete = 0
    </where>
    ORDER BY sg.storage_goods_id DESC
  </select>
</mapper>