<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mingyuansoftware.aifactory.mapper.WarehousePositionMapper">
    <resultMap id="BaseResultMap" type="com.mingyuansoftware.aifactory.model.WarehousePosition">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="wp_id" property="wpId" jdbcType="INTEGER"/>
        <result column="wp_name" property="wpName" jdbcType="VARCHAR"/>
        <result column="warehouse_id" property="warehouseId" jdbcType="INTEGER"/>
        <result column="state" property="state" jdbcType="TINYINT"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="update_time" property="updateTime" jdbcType="TIMESTAMP"/>
        <result column="is_delete" property="isDelete" jdbcType="TINYINT"/>
    </resultMap>
    <insert id="addWarehousePosition" parameterType="com.mingyuansoftware.aifactory.model.WarehousePosition">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <selectKey resultType="java.lang.Integer" keyProperty="wpId" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>
        insert into warehouse_position (wp_name, warehouse_id, `state`,
        create_time,comment
        )
        values (#{wpName,jdbcType=VARCHAR}, #{warehouseId,jdbcType=INTEGER}, #{state,jdbcType=TINYINT},
        #{createTime,jdbcType=TIMESTAMP},#{comment,jdbcType=VARCHAR}
        )
    </insert>
    <update id="editWP" parameterType="com.mingyuansoftware.aifactory.model.WarehousePosition">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update warehouse_position
        set wp_name = #{wpName,jdbcType=VARCHAR},
        warehouse_id = #{warehouseId,jdbcType=INTEGER},
        `state` = #{state,jdbcType=TINYINT},
        update_time = now(),
        `comment`= #{comment,jdbcType=VARCHAR}
        where wp_id = #{wpId,jdbcType=INTEGER}
    </update>
    <!--删除仓位,根据仓位id修改仓位状态 1.表示空闲 2.表示使用中-->
    <update id="deleteWPById" parameterType="java.lang.Integer">
        update warehouse_position
        set
        update_time = now(),
        is_delete = 1
        where wp_id = #{warehousePositionId,jdbcType=INTEGER}
    </update>
    <!--根据id查询仓位-->
    <select id="selectEditWP" resultType="com.mingyuansoftware.aifactory.model.WarehousePosition"
            parameterType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select wp_id, wp_name, warehouse_id, `state`, create_time, update_time,comment, is_delete
        from warehouse_position
        where wp_id = #{warehousePositionId,jdbcType=INTEGER}
    </select>
    <select id="selectWarehousePositionAll" resultType="com.mingyuansoftware.aifactory.model.dto.WarehousePositionDto"
            parameterType="com.mingyuansoftware.aifactory.model.dto.WarehousePositionDto">
        select wp.wp_id, wp.wp_name, w.warehouse_name, wp.state,DATE_FORMAT(wp.create_time,'%Y-%m-%d') as
        createTime, wp.update_time,wp.`comment`
        from warehouse_position as wp
        left join warehouse as w on wp.warehouse_id = w.warehouse_id
        where wp.is_delete = 0
        <if test="wpName != ''and wpName != null">
            and wp.wp_name like "%"#{wpName,jdbcType=VARCHAR}"%"
        </if>
        <if test="warehouseName != ''and warehouseName != null">
            and w.warehouse_name like "%"#{warehouseName,jdbcType=VARCHAR}"%"
        </if>
        <if test="createTime != ''and createTime != null">
            and wp.create_time like "%"#{createTime,jdbcType=VARCHAR}"%"
        </if>
    </select>
    <!--仓位列表数量-->
    <select id="count" resultType="java.lang.Integer"
            parameterType="com.mingyuansoftware.aifactory.model.dto.WarehousePositionDto">
        select count(*)
        from warehouse_position as wp
        where wp.is_delete = 0
        <if test="wpName != ''and wpName != null">
            and wp.wp_name like "%"#{wpName,jdbcType=VARCHAR}"%"
        </if>
        <if test="warehouseName != ''and warehouseName != null">
            and w.warehouse_name like "%"#{warehouseName,jdbcType=VARCHAR}"%"
        </if>
        <if test="createTime != ''and createTime != null">
            and wp.create_time like "%"#{createTime,jdbcType=VARCHAR}"%"
        </if>
    </select>

    <select id="selectWpNameList" resultType="com.mingyuansoftware.aifactory.model.WarehousePosition">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select wp_id, wp_name, warehouse_id, `state`, create_time, update_time,comment, is_delete
        from warehouse_position
        where is_delete = 0
    </select>

    <update id="updateWarehousePrositonState" parameterType="java.lang.Integer">
        update warehouse_position
        set
        update_time = now(),
        state = 2
        where wp_id = #{warehousePositionId,jdbcType=INTEGER}
    </update>

    <select id="selectWpList" resultType="com.mingyuansoftware.aifactory.model.WarehousePosition">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select wp_id, wp_name, warehouse_id, `state`, create_time, update_time,comment, is_delete
        from warehouse_position
        where is_delete = 0
        <if test="wpName != ''and wpName != null">
            and wp_name like "%"#{wpName,jdbcType=VARCHAR}"%"
        </if>
    </select>

</mapper>