<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mingyuansoftware.aifactory.mapper.InventoryCheckGoodsMapper" >
  <resultMap id="BaseResultMap" type="com.mingyuansoftware.aifactory.model.InventoryCheckGoods" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="inventory_check_goods_id" property="inventoryCheckGoodsId" jdbcType="INTEGER" />
    <result column="inventory_check_id" property="inventoryCheckId" jdbcType="INTEGER" />
    <result column="goods_id" property="goodsId" jdbcType="INTEGER" />
    <result column="stock_quantity" property="stockQuantity" jdbcType="DECIMAL" />
    <result column="inventory_quantity" property="inventoryQuantity" jdbcType="DECIMAL" />
    <result column="surplus_quantity" property="surplusQuantity" jdbcType="DECIMAL" />
    <result column="deficit_quantity" property="deficitQuantity" jdbcType="DECIMAL" />
    <result column="warehouse_position" property="warehousePosition" jdbcType="VARCHAR" />
    <result column="staff_id" property="staffId" jdbcType="INTEGER" />
    <association column="goods_id" property="goods"
                 select="com.mingyuansoftware.aifactory.mapper.GoodsMapper.selectByPrimaryKey"></association>
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from inventory_check_goods
    where inventory_check_id = #{inventoryCheckId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.mingyuansoftware.aifactory.model.InventoryCheckGoods" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey resultType="java.lang.Integer" keyProperty="inventoryCheckGoodsId" order="AFTER" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into inventory_check_goods (inventory_check_id, goods_id, stock_quantity, 
      inventory_quantity, surplus_quantity, deficit_quantity, 
      warehouse_position, staff_id, pda_state)
    values (#{inventoryCheckId,jdbcType=INTEGER}, #{goodsId,jdbcType=INTEGER}, #{stockQuantity,jdbcType=DECIMAL}, 
      #{inventoryQuantity,jdbcType=DECIMAL}, #{surplusQuantity,jdbcType=DECIMAL}, #{deficitQuantity,jdbcType=DECIMAL}, 
      #{warehousePosition,jdbcType=VARCHAR}, #{staffId,jdbcType=INTEGER},#{pdaState,jdbcType=INTEGER})
  </insert>
  <update id="updateByPrimaryKey" parameterType="com.mingyuansoftware.aifactory.model.InventoryCheckGoods" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update inventory_check_goods
    set inventory_check_id = #{inventoryCheckId,jdbcType=INTEGER},
      goods_id = #{goodsId,jdbcType=INTEGER},
      stock_quantity = #{stockQuantity,jdbcType=DECIMAL},
      inventory_quantity = #{inventoryQuantity,jdbcType=DECIMAL},
      surplus_quantity = #{surplusQuantity,jdbcType=DECIMAL},
      deficit_quantity = #{deficitQuantity,jdbcType=DECIMAL},
      warehouse_position = #{warehousePosition,jdbcType=VARCHAR},
      staff_id = #{staffId,jdbcType=INTEGER}
    where inventory_check_goods_id = #{inventoryCheckGoodsId,jdbcType=INTEGER}
  </update>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select icgd.inventory_check_goods_id, icgd.inventory_check_id, icgd.goods_id, icgd.inventory_quantity,
    icgd.surplus_quantity, icgd.deficit_quantity, icgd.warehouse_position, icgd.staff_id, sf.`name`, icgd.pda_state
    from inventory_check_goods as icgd
    left join staff as sf on (icgd.staff_id = sf.staff_id)
    where icgd.inventory_check_id = #{inventoryCheckId,jdbcType=INTEGER}
  </select>
  <select id="selectAll" resultMap="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select inventory_check_goods_id, inventory_check_id, goods_id, stock_quantity, inventory_quantity, 
    surplus_quantity, deficit_quantity, warehouse_position, staff_id
    from inventory_check_goods
  </select>
  <update id="updateInventoryCheckGoodsState" >
    update inventory_check_goods
    set
    pda_state = 2,
    inventory_quantity = #{inventoryQuantity,jdbcType=DECIMAL},
    staff_id = #{staffId,jdbcType=INTEGER}
    where inventory_check_goods_id = #{inventoryCheckGoodsId,jdbcType=INTEGER}
  </update>
  <select id="selectById" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    select inventory_check_goods_id, inventory_check_id, goods_id, stock_quantity, inventory_quantity,
    surplus_quantity, deficit_quantity, warehouse_position, staff_id,pda_state
    from inventory_check_goods
    where inventory_check_goods_id = #{inventoryCheckGoodsId,jdbcType=INTEGER}
  </select>
  <update id="updateInventorCheckQuantity" parameterType="com.mingyuansoftware.aifactory.model.InventoryCheckGoods" >
    update inventory_check_goods
    set
    inventory_quantity = #{inventoryCheckGoods.inventoryQuantity,jdbcType=DECIMAL},
    surplus_quantity = #{inventoryCheckGoods.surplusQuantity,jdbcType=DECIMAL},
    deficit_quantity = #{inventoryCheckGoods.deficitQuantity,jdbcType=DECIMAL}
    where inventory_check_goods_id = #{inventoryCheckGoods.inventoryCheckGoodsId,jdbcType=INTEGER}
  </update>
  <select id="selectInventoryCheckGoodsId" resultType="java.lang.Integer" >
    select inventory_check_goods_id
    from inventory_check_goods
    where inventory_check_id = #{inventoryCheckId} and goods_id = #{goodsId}
  </select>
  <select id="selectQuantityByGId" resultMap="BaseResultMap">
    select gid,sum(skg_count) as stock_quantity,warehouse_id,skg_create_datetime,skg_type,skg_dan_jia,
    skg_serial_number, skg_wanglai_danwei
    from stock_kucun_goods
    where gid = #{goodsId} and warehouse_id = #{warehouseId}
    group by gid
  </select>
</mapper>