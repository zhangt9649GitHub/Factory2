<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mingyuansoftware.aifactory.mapper.ReceiptMapper" >
  <resultMap id="BaseResultMap" type="com.mingyuansoftware.aifactory.model.Receipt" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="receipt_id" property="receiptId" jdbcType="INTEGER" />
    <result column="receipt_number" property="receiptNumber" jdbcType="VARCHAR" />
    <result column="category" property="category" jdbcType="VARCHAR" />
    <result column="payer" property="payer" jdbcType="VARCHAR" />
    <result column="payer_id" property="payerId" jdbcType="INTEGER" />
    <result column="associated_document" property="associatedDocument" jdbcType="VARCHAR" />
    <result column="sale_id" property="saleId" jdbcType="INTEGER" />
    <result column="amount" property="amount" jdbcType="DECIMAL" />
    <result column="amount_receivable" property="amountReceivable" jdbcType="DECIMAL" />
    <result column="pending_write_off_amount" property="pendingWriteOffAmount" jdbcType="DECIMAL" />
    <result column="collection_amount" property="collectionAmount" jdbcType="DECIMAL" />
    <result column="write_off_amount" property="writeOffAmount" jdbcType="DECIMAL" />
    <result column="payment_method" property="paymentMethod" jdbcType="VARCHAR" />
    <result column="comment" property="comment" jdbcType="VARCHAR" />
    <result column="staff_id" property="staffId" jdbcType="INTEGER" />
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
    <result column="update_time" property="updateTime" jdbcType="TIMESTAMP" />
    <result column="cj_time" property="cjTime" jdbcType="TIMESTAMP" />
    <result column="is_delete" property="isDelete" jdbcType="TINYINT" />
    <result column="name" property="name" jdbcType="VARCHAR" />
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    UPDATE  receipt set  is_delete =1
    where receipt_id = #{receiptId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.mingyuansoftware.aifactory.model.Receipt" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey resultType="java.lang.Integer" keyProperty="receiptId" order="AFTER" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into receipt (receipt_number, category, payer,payer_id,
      associated_document, sale_id, amount, amount_receivable,
      pending_write_off_amount, collection_amount, 
      write_off_amount, payment_method, `comment`, 
      staff_id, create_time, update_time, cj_time,
      is_delete)
    values (#{receiptNumber,jdbcType=VARCHAR}, #{category,jdbcType=VARCHAR}, #{payer,jdbcType=VARCHAR}, #{payerId,jdbcType=INTEGER},
      #{associatedDocument,jdbcType=VARCHAR},  #{saleId,jdbcType=INTEGER}, #{amount,jdbcType=DECIMAL}, #{amountReceivable,jdbcType=DECIMAL},
      #{pendingWriteOffAmount,jdbcType=DECIMAL}, #{collectionAmount,jdbcType=DECIMAL}, 
      #{writeOffAmount,jdbcType=DECIMAL}, #{paymentMethod,jdbcType=VARCHAR}, #{comment,jdbcType=VARCHAR}, 
      #{staffId,jdbcType=INTEGER}, #{createTime,jdbcType=TIMESTAMP}, #{updateTime,jdbcType=TIMESTAMP}, #{cjTime,jdbcType=TIMESTAMP},
      #{isDelete,jdbcType=TINYINT})
  </insert>
  <update id="updateByPrimaryKey" parameterType="com.mingyuansoftware.aifactory.model.Receipt" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update receipt
    set receipt_number = #{receiptNumber,jdbcType=VARCHAR},
      category = #{category,jdbcType=VARCHAR},
      payer = #{payer,jdbcType=VARCHAR},
      payer_id = #{payerId,jdbcType=INTEGER},
      associated_document = #{associatedDocument,jdbcType=VARCHAR},
      sale_id = #{saleId,jdbcType=INTEGER},
      amount = #{amount,jdbcType=DECIMAL},
      amount_receivable = #{amountReceivable,jdbcType=DECIMAL},
      pending_write_off_amount = #{pendingWriteOffAmount,jdbcType=DECIMAL},
      collection_amount = #{collectionAmount,jdbcType=DECIMAL},
      write_off_amount = #{writeOffAmount,jdbcType=DECIMAL},
      payment_method = #{paymentMethod,jdbcType=VARCHAR},
      `comment` = #{comment,jdbcType=VARCHAR},
      staff_id = #{staffId,jdbcType=INTEGER},
      update_time = #{updateTime,jdbcType=TIMESTAMP},
    cj_time = #{cjTime,jdbcType=TIMESTAMP}
    where receipt_id = #{receiptId,jdbcType=INTEGER}
  </update>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select r.receipt_id, r.receipt_number, r.category, r.payer, r.payer_id,
     r.sale_id, r.associated_document, r.amount,
    r.amount_receivable, r.pending_write_off_amount, r.collection_amount, r.write_off_amount,
    r.payment_method, r.`comment`, r.staff_id, r.cj_time,sf.name
    from receipt r
    LEFT JOIN staff  sf on(r.staff_id = sf.staff_id)
    where r.receipt_id = #{receiptId,jdbcType=INTEGER} and r.is_delete=0
  </select>
  <select id="selectAll" resultType="com.mingyuansoftware.aifactory.model.dto.ReceiptDto">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select r.receipt_id,  r.receipt_number,  r.category,  r.payer, r.collection_amount,  r.`comment`,  r.cj_time, sf.name
    from receipt r
    LEFT JOIN staff  sf on(r.staff_id = sf.staff_id)
    <where>
      <if test="receiptNumber!= null and receiptNumber != ''">
        AND r.receipt_number like "%"#{receiptNumber}"%"
      </if>
      <if test="category != null and category!= ''">
        AND r.category like "%"#{category}"%"
      </if>
      <if test="name != null and name != ''">
        AND sf.name like "%"#{name}"%"
      </if>
      <if test="cjTime != null and cjTime != ''">
        AND  r.cj_time like "%"#{cjTime}"%"
      </if>
      <if test="payer != null and payer != ''">
        AND  r.payer like "%"#{payer}"%"
      </if>
      <if test="comment != null and comment != ''">
        AND r.`comment` = #{comment}
      </if>
      <if test="collectionAmount != null and collectionAmount != ''">
        AND r.collection_amount = #{collectionAmount}
      </if>
      AND r.is_delete = 0
    </where>

  </select>
</mapper>