<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mingyuansoftware.aifactory.mapper.OutboundOrderDetailsMapper" >
  <resultMap id="BaseResultMap" type="com.mingyuansoftware.aifactory.model.OutboundOrderDetails" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="outbound_order_details_id" property="outboundOrderDetailsId" jdbcType="INTEGER" />
    <result column="outbound_order_id" property="outboundOrderId" jdbcType="INTEGER" />
    <result column="quantity" property="quantity" jdbcType="DECIMAL" />
    <result column="amount" property="amount" jdbcType="DECIMAL" />
    <result column="comment" property="comment" jdbcType="VARCHAR" />
    <association column="goods_id" property="goods"
                 select="com.mingyuansoftware.aifactory.mapper.GoodsMapper.selectByPrimaryKey"></association>
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from outbound_order_details
    where outbound_order_details_id = #{outboundOrderDetailsId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.mingyuansoftware.aifactory.model.OutboundOrderDetails" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey resultType="java.lang.Integer" keyProperty="outboundOrderDetailsId" order="AFTER" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into outbound_order_details (outbound_order_id, goods_id, quantity, 
      amount, `comment`)
    values (#{outboundOrderId,jdbcType=INTEGER}, #{goodsId,jdbcType=INTEGER}, #{quantity,jdbcType=DECIMAL}, 
      #{amount,jdbcType=DECIMAL}, #{comment,jdbcType=VARCHAR})
  </insert>
  <update id="updateByPrimaryKey" parameterType="com.mingyuansoftware.aifactory.model.OutboundOrderDetails" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update outbound_order_details
    set outbound_order_id = #{outboundOrderId,jdbcType=INTEGER},
      goods_id = #{goodsId,jdbcType=INTEGER},
      quantity = #{quantity,jdbcType=DECIMAL},
      amount = #{amount,jdbcType=DECIMAL},
      `comment` = #{comment,jdbcType=VARCHAR}
    where outbound_order_details_id = #{outboundOrderDetailsId,jdbcType=INTEGER}
  </update>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select outbound_order_details_id, outbound_order_id, goods_id, quantity, amount, 
    `comment`
    from outbound_order_details
    where outbound_order_details_id = #{outboundOrderDetailsId,jdbcType=INTEGER}
  </select>
  <select id="selectAll" resultMap="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select outbound_order_details_id, outbound_order_id, goods_id, quantity, amount, 
    `comment`
    from outbound_order_details
  </select>
  <select id="selectOutboundOrderDetailsById" resultMap="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select outbound_order_details_id, outbound_order_id, goods_id, quantity, amount,
    `comment`
    from outbound_order_details
    where outbound_order_id = #{outboundOrderId}
  </select>

  <select id="selectOutboundOrderDetailsList" resultType="com.mingyuansoftware.aifactory.model.dto.OutboundOrderDetailsDto" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select ood.outbound_order_details_id, ood.outbound_order_id,IFNULL(ood.quantity,0) AS quantity, IFNULL(ood.amount,0) AS amount,
    gd.parts_cd,gd.goods_name,gd.specification,gd.category,oo.outbound_order_number,
    oo.add_time,oo.type,wh.warehouse_name
    from outbound_order_details AS ood
    LEFT JOIN outbound_order AS oo ON (ood.outbound_order_id = oo.outbound_order_id)
    LEFT JOIN goods AS gd ON (ood.goods_id = gd.goods_id)
    LEFT JOIN warehouse AS wh ON (oo.warehouse_id = wh.warehouse_id)
    <where>
      <if test="outboundOrderDetailsDto.partsCd != null and outboundOrderDetailsDto.partsCd != ''">
        AND gd.parts_cd like "%"#{outboundOrderDetailsDto.partsCd}"%"
      </if>
      <if test="outboundOrderDetailsDto.goodsName != null and outboundOrderDetailsDto.goodsName != ''">
        AND gd.goods_name like "%"#{outboundOrderDetailsDto.goodsName}"%"
      </if>
      <if test="outboundOrderDetailsDto.specification != null and outboundOrderDetailsDto.specification  != ''">
        AND gd.specification like "%"#{outboundOrderDetailsDto.specification}"%"
      </if>
      <if test="outboundOrderDetailsDto.quantity != null and outboundOrderDetailsDto.quantity != '' or outboundOrderDetailsDto.quantity == '0'.toString()">
        AND ood.quantity = #{outboundOrderDetailsDto.quantity}
      </if>
      <if test="outboundOrderDetailsDto.outboundOrderNumber != null and outboundOrderDetailsDto.outboundOrderNumber  != ''">
        AND oo.outbound_order_number like "%"#{outboundOrderDetailsDto.outboundOrderNumber}"%"
      </if>
      <if test="outboundOrderDetailsDto.addTime != null and outboundOrderDetailsDto.addTime  != ''">
        AND oo.add_time like "%"#{outboundOrderDetailsDto.addTime}"%"
      </if>
      <if test="outboundOrderDetailsDto.type != null and outboundOrderDetailsDto.type  != ''">
        AND oo.type  like "%"#{outboundOrderDetailsDto.type}"%"
      </if>
      <if test="outboundOrderDetailsDto.warehouseName != null and outboundOrderDetailsDto.warehouseName  != ''">
        AND wh.warehouse_name like "%"#{outboundOrderDetailsDto.warehouseName}"%"
      </if>
      <if test="outboundOrderDetailsDto.category != null and outboundOrderDetailsDto.category  != ''">
        AND gd.category = #{outboundOrderDetailsDto.category}
      </if>
      <if test="outboundOrderDetailsDto.amount != null and outboundOrderDetailsDto.amount  != '' or outboundOrderDetailsDto.amount == '0'.toString()">
        AND ood.amount = #{outboundOrderDetailsDto.amount}
      </if>
      <if test="startTime != null and startTime  != ''">
        AND oo.add_time >= #{startTime}
      </if>
      <if test="endTime != null and endTime  != ''">
        AND oo.add_time &lt;= #{endTime}
      </if>
      AND oo.is_delete = 0
    </where>
    ORDER BY ood.outbound_order_details_id DESC
  </select>

  <select id="selectCount" resultType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select COUNT(ood.outbound_order_details_id)
    from outbound_order_details AS ood
    LEFT JOIN outbound_order AS oo ON (ood.outbound_order_id = oo.outbound_order_id)
    LEFT JOIN goods AS gd ON (ood.goods_id = gd.goods_id)
    LEFT JOIN warehouse AS wh ON (oo.warehouse_id = wh.warehouse_id)
    <where>
      <if test="outboundOrderDetailsDto.partsCd != null and outboundOrderDetailsDto.partsCd != ''">
        AND gd.parts_cd like "%"#{outboundOrderDetailsDto.partsCd}"%"
      </if>
      <if test="outboundOrderDetailsDto.goodsName != null and outboundOrderDetailsDto.goodsName != ''">
        AND gd.goods_name like "%"#{outboundOrderDetailsDto.goodsName}"%"
      </if>
      <if test="outboundOrderDetailsDto.specification != null and outboundOrderDetailsDto.specification  != ''">
        AND gd.specification like "%"#{outboundOrderDetailsDto.specification}"%"
      </if>
      <if test="outboundOrderDetailsDto.quantity != null and outboundOrderDetailsDto.quantity != '' or outboundOrderDetailsDto.quantity == '0'.toString()">
        AND ood.quantity = #{outboundOrderDetailsDto.quantity}
      </if>
      <if test="outboundOrderDetailsDto.outboundOrderNumber != null and outboundOrderDetailsDto.outboundOrderNumber  != ''">
        AND oo.outbound_order_number like "%"#{outboundOrderDetailsDto.outboundOrderNumber}"%"
      </if>
      <if test="outboundOrderDetailsDto.addTime != null and outboundOrderDetailsDto.addTime  != ''">
        AND oo.add_time like "%"#{outboundOrderDetailsDto.addTime}"%"
      </if>
      <if test="outboundOrderDetailsDto.type != null and outboundOrderDetailsDto.type  != ''">
        AND oo.type  like "%"#{outboundOrderDetailsDto.type}"%"
      </if>
      <if test="outboundOrderDetailsDto.warehouseName != null and outboundOrderDetailsDto.warehouseName  != ''">
        AND wh.warehouse_name like "%"#{outboundOrderDetailsDto.warehouseName}"%"
      </if>
      <if test="outboundOrderDetailsDto.category != null and outboundOrderDetailsDto.category  != ''">
        AND gd.category = #{outboundOrderDetailsDto.category}
      </if>
      <if test="outboundOrderDetailsDto.amount != null and outboundOrderDetailsDto.amount  != ''  or outboundOrderDetailsDto.amount == '0'.toString()">
        AND ood.amount = #{outboundOrderDetailsDto.amount}
      </if>
      <if test="startTime != null and startTime  != ''">
        AND oo.add_time >= #{startTime}
      </if>
      <if test="endTime != null and endTime  != ''">
        AND oo.add_time &lt;= #{endTime}
      </if>
      AND oo.is_delete = 0
    </where>
    ORDER BY ood.outbound_order_details_id DESC
  </select>
</mapper>